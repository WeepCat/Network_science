# 图谱理论

图谱理论是一个非常有效而又优雅的理论，主要用于回答下列两个问题:

当使用矩阵来表示一个图时，

-   矩阵具有哪些性质？
-   矩阵的特征值和特征向量呈现什么样的特性？

本章我们只讨论不存在自环的无向无权图，尽管大多数结论都可以扩展到有向图和加权图中。

## 图的矩阵表示

给定一个图 $G = \{V, E\}$，其中节点的个数 $\vert V \vert = n$, 我们可以得到这个图的邻接矩阵 $\mathbf{A} \in \{0, 1\}^{n \times n}$, 很自然地可以得到它的**拉普拉斯矩阵 $\mathbf{L}$**.

**拉普拉斯矩阵（Laplacian Matrix）**：（也叫做 admittance matrix, Kirchhoff matrix）给定一个图 $G=\{V, E\}$，其邻接矩阵为 $\textbf{A}$，其拉普拉斯矩阵 $\textbf{L}$ 定义为 $\textbf{L} = \textbf{D} - \textbf{A}$ 其中 $\textbf{D} = \textbf{diag}(\textbf{d}(v_1), \ldots, \textbf{d}(v_N))$ 是度矩阵。更具体地，我们记拉普拉斯矩阵中每一个元素为 $\textbf{L}_{ij}$，那么每一个元素可以被定义为:
$$
\textbf{L}_{ij} = \left \{

\begin{array}{lll}
d_i, & \mathrm{if} \ i=j \\
-1, & \mathrm{if} \ i \ne j \ \mathrm{and} \ v_i \ \mathrm{adjacent \ with} \ v_j \\
0, & \mathrm{otherwise}
\end{array} 

\right .
$$
它的每一行和列的加和为 $0$。

为了更加直观地理解拉普拉斯矩阵，我们考虑一个向量 $v$ 与拉普拉斯矩阵 $\mathbf{L}$ 的矩阵乘法, $w = \mathbf{L}v$:
$$
w(i) = deg(i)v(i) - \sum_{j:(i, j) \in E}v_{j} = \sum_{j:(i, j)\in E}(v(i) - v(j)).
$$

>   $w$ 中的第 $i$ 个元素是 $v(i)$ 与图 $G$  中 $i$ 的邻域对应的 $v$ 的索引之间的差值之和

考虑二次型 $v^{T}\mathbf{L}v$:
$$
\begin{aligned}
v^{T}\mathbf{L}v &= \sum_{i}v(i)\sum_{j:(i, j) \in E}(v(i) - v(j)) \\
&= \sum_{(i, j) \in E} v(i)(v(i) - v(j)) \\
&= \sum_{i \lt j:(i, j) \in E} v(i)(v(i) - v(j)) + v(j)(v(i) - v(j)) \\ 
&= \sum_{i \lt j:(i, j) \in E}(v(i) - v(j))^{2}.
\end{aligned}
$$
换句话说，如果把向量 $v$ 理解为给图 $G$ 中的每个顶点分配一个编号，那么 $v^{T}\mathbf{L}v $ 量就是相邻节点编号之差的平方和。

## 特征值和特征向量

因为 $\mathbf{L}$ 是实对称矩阵，所以它的所有特征值都是实数，并且特征向量彼此正交。对于二次型 $v^{T}\mathbf{L}v$ 而言，它可以写成式 $(3)$ 的形式，即对任意的向量 $v$, 二次型 $v^{T}\mathbf{L}v \ge 0$ ，故**拉普拉斯矩阵 $\mathbf{L}$ 是半正定的**，因此 $\mathbf{L}$ 的全体特征值均非负.

### $0$ 特征值的含义

**定理:** 拉普拉斯矩阵 $\mathbf{L}$ 的 $0$ 特征值(根)的重数等于图 $G$ 中连通分量的个数

**证明**

>   先证 $0$ 特征根的重数是图 $G$ 的连通分量个数的下界
>
>   设图 $G$ 中的连通分量个数为 $k$, 得到节点集合 $V$ 的一个划分 $S_1, \ldots, S_k$, 其中, $S_i \cap S_j = \emptyset, i\ne j$ 且 $\cup_{i=1}^{k}S_i = V$.
>
>   构造 $k$ 个向量 $v_1, \ldots, v_k$, 其中 $v_i(j) = \frac{1}{\sqrt{\vert S_i \vert}}, \mathrm{if}\ j \in S_i, \mathrm{otherwise} \ 0$.  $v_i$ 的长度 $\Vert v_i \Vert = 1$, 并且因为 $S_i \cap S_j = \emptyset, i \ne j$, 故 $<v_i, v_j> = 0$, 即任意两个向量 $v_i, v_j, i\ne j$ 都是正交的. 并且很自然地可以得到: $Lv_i = 0, i=1, \ldots, k$, 这表明在拉普拉斯矩阵 $\mathbf{L}$ 中属于特征值 $0$ 的特征向量至少有 $k$ 个.
>
>   再证 $0$ 特征根的重数是图 $G$ 的连通分量个数的上界
>
>   假设除了这 $k$ 个向量外，拉普拉斯矩阵 $\mathbf{L}$ 还存在其他的属于特征值 $0$ 的特征向量，不妨记为 $v_{k+1}$, 那么 $v_{k+1}$ 是与 $v_1, \ldots, v_k$ 正交
>
>   所以 $v_{k+1}$ 不是零向量，记不为 $0$ 的这些分量对应的维度为 $I_{v_{k+1}}$, 
>
>   又由 $Lv = 0 \rightarrow v^{T}Lv = 0 \Leftrightarrow$ $v$ 中的每个分量都相等，故 $v_{k+1}$ 中的每个分量都相等
>
>   如果划分 $S_i, i=1, \ldots, k$ 与 $I_{v_{k+1}}$ 重合，则 $v_{i}$ 与 $v_{k+1}$ 的内积必定不为 $0$, 即 $v_{k+1}$ 与 $v_i$ 不是正交的, 这与假设矛盾，所以拉普拉斯矩阵 $\mathbf{L}$ 最多只有 $k$ 个属于特征值 $0$ 的特征向量
>
>   综上可得，$\mathbf{L}$ 的 $0$ 特征值(根)的重数等于图 $G$ 中连通分量的个数

### 最大/最小(非零)特征值(特征向量)的含义

考虑二次型 $v^{T}\mathbf{L}v$, 若 $v$ 是 $\mathbf{L}$ 的特征向量，则 $v^{T}\mathbf{L}v$ 等于特征向量 $v$ 所对应的特征值。而二次型 $v^{T}\mathbf{L}v$ 是相邻的两个节点间相似性的一种刻画，也就是说，如果节点

## 图谱理论的应用

### 谱嵌入(可视化)

### 谱聚类

### 图着色







